# wiringpi
PKG_SUFFIX=".20211223"
PKG_URL="https://github.com/WiringPi/WiringPi/archive/5de0d8f5739ccc00ab761639a7e8d3d1696a480a.tar.gz"
PATCHES="wiringpi-makefiles.patch"
BUILD_PROCESS=simplemake
INST_CMD=install
PKG_DEPS=
PKG_MAKEVARS="PREFIX=${BUILD_PREFIX} HARCH=${HARCH} EXTRA_CFLAGS=\"\${CFLAGS}\" EXTRA_LDFLAGS=\"\${LDFLAGS}\" WIRINGPI_SUID=0 DEBUG= "

PKG_PREBUILD="
cat >Makefile <<EOF
all:
	cd wiringPi && \\\$(MAKE)
	cd devLib && \\\$(MAKE)
	cd gpio && \\\$(MAKE)

install:
	install -d \\\$(DESTDIR)\\\$(PREFIX)/lib/\\\$(HARCH)
	install -d \\\$(DESTDIR)\\\$(PREFIX)/bin
	cd wiringPi && \\\$(MAKE) install
	cd devLib && \\\$(MAKE) install
	cd gpio && \\\$(MAKE) install

clean:
	cd wiringPi && \\\$(MAKE) clean
	cd devLib && \\\$(MAKE) clean
	cd gpio && \\\$(MAKE) clean
EOF
"

### GCC 10 Workaround ####
test_version ${GCC_VER} -ge 10 && PKG_CFLAGS+=" -fcommon" || true
##########################
