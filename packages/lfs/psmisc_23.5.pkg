# psmisc_23.5
PKG_URL="https://sourceforge.net/projects/psmisc/files/psmisc/psmisc-23.5.tar.xz"
PKG_DEPS="lfs/ncurses_6.3+p20220820"
BUILD_PROCESS=configmake
AUTOCONF=1
CONF_FLAGS="ac_cv_func_malloc_0_nonnull=yes ac_cv_func_realloc_0_nonnull=yes"
INST_CMD="install-strip"

PKG_PREBUILD="cat <<EOF | patch -s -p0 || true
--- configure.ac.orig   2021-02-08 18:00:40.570000000 +0100
+++ configure.ac        2021-02-08 18:03:03.300000000 +0100
@@ -74,10 +74,12 @@
 dnl Checks for libraries.
 AC_CHECK_LIB([tinfo], [tgetent], [TERMCAP_LIB=-ltinfo],
   [ AC_CHECK_LIB([ncurses], [tgetent], [TERMCAP_LIB=-lncurses],
-    [ AC_CHECK_LIB([termcap], [tgetent], [TERMCAP_LIB=-ltermcap], 
-      [ AC_MSG_ERROR([Cannot find tinfo, ncurses or termcap libraries])
-\$(echo -e '\\t')  ] )
-\$(echo -e '\\t')] )
+    [ AC_CHECK_LIB([ncursesw], [tgetent], [TERMCAP_LIB=-lncursesw],
+      [ AC_CHECK_LIB([termcap], [tgetent], [TERMCAP_LIB=-ltermcap],
+        [ AC_MSG_ERROR([Cannot find tinfo, ncurses or termcap libraries])
+        ] )
+      ] )
+    ] )
   ] )
 AC_SUBST([TERMCAP_LIB])
EOF
"
